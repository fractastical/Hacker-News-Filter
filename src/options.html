<html>
<head><title>Options for Hacker News Filter</title></head>
<script type="text/javascript">

/* Each filterValue set has:

   (1) title
   (2) description
   (3) values - JSON String of filters
   (4) pages - Number of Pages to display

  There is also an activeFilter toggle.

*/

// Saves options to localStorage.
function save_options() {

  var friends = document.getElementById("friends");
  localStorage["friends"] = friends.value;

  var activeFilter = document.getElementById("activeFilter");
  localStorage["activeFilter"] = activeFilter.value;

  var filterValues = document.getElementById("filterValues");
  localStorage["filterValues"] = filterValues.value;

  // Update status to let user know options were saved.
  var status = document.getElementById("status");
  status.innerHTML = "Options Saved.";
  setTimeout(function() {
    status.innerHTML = "";
  }, 750);

}

// Restores select box state to saved value from localStorage.
function restore_options() {

  var data = localStorage["filterValues"];
  if (!data) {
	var ob= {
	    "standard": {
	        "description": "everything except bitcoin",
	        "pages": "1",
	        "data": {
	            "default": 1,
	            "bitcoin": 250
	        }
	    },
	    "weekly roundup": {
	        "description": "make sure I did not miss anything important this week",
	        "pages": "15",
	        "data": {
	            "default": 250,
	            "heroku": 5,
	            "python": 10,
	            "rails": 40,
	            "jquery": 20,
	            "clojure": 10
	        }
	    },
	    "find all": {
	        "description": "find everything in the last month including certain keyword",
	        "pages": "100",
	        "data": {
	            "default": 1000,
	            "github": 1
	        }
	    }
	};
	data = JSON.stringify(ob);
  }


  var friends = localStorage["friends"];
  if (!friends) {
	var frob= {
	    "allstars": {
	        "pg": 4
	    },
	    "philly": {
	        "yegg": 1,
	        "aaronfeng": 1
	    },
	    "rome": {
	        "jd": 1
	    },
	    "munich": {
	        "moconnor": 1,
	        "HSO": 1,
	        "hessenwolf": 1,
	        "Jakob": 1,
	        "DrinkWater": 1,
	        "wink": 1,
	        "schuon": 1,
	        "gilligan": 1,
	        "justliving": 1,
	        "hef19898": 1,
	        "jwildeboer": 1,
	        "s1rech": 1,
	        "struppi": 1
	    }
	};
	friends = JSON.stringify(frob);
  }


				
  var parsedData = JSON.parse(data);
  var formattedData = JSON.stringify(parsedData, null, '\t');
  var activeFilter = document.getElementById("filterValues");
  activeFilter.value = formattedData;

  var parsedFriends = JSON.parse(friends);
  var formattedFriends = JSON.stringify(parsedFriends, null, '\t');
  var friends = document.getElementById("friends");
  friends.value = formattedFriends;

  var activeFilter = document.getElementById("activeFilter");
  activeFilter.value = localStorage["activeFilter"];

  var isFriendsActive = document.getElementById("isFriendsActive");
  isFriendsActive.value = localStorage["isFriendsActive"];
  
}

</script>

<body onload="restore_options()">

<p>Json for filters:</p>

<textarea id="filterValues" rows="35" cols="90"></textarea>

<p>Title of active filter:</p>

<p><input type="text" id="activeFilter" size="30" /></p>

<p>Json for friends:</p>

<textarea id="friends" rows="35" cols="90"></textarea>

<p>Friends feature active?
	
<p>Yes <input type="checkbox" id="isFriendsActive" /></p>

<div id="status">&nbsp;</div>
<br>
<button onclick="save_options()">Save</button>
</body>
</html>
